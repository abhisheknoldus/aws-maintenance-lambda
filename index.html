<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>aws-maintenance-lambda by indix</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">aws-maintenance-lambda</h1>
      <h2 class="project-tagline">A lambda function to send alerts (to Slack) on AWS maintenance events.</h2>
      <a href="https://github.com/indix/aws-maintenance-lambda" class="btn">View on GitHub</a>
      <a href="https://github.com/indix/aws-maintenance-lambda/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/indix/aws-maintenance-lambda/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="aws-maintenance-lambda" class="anchor" href="#aws-maintenance-lambda" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>aws-maintenance-lambda</h1>

<p>A lambda function to send alerts (to Slack) on AWS maintenance events. While the email from AWS includes only the instance id, the alert will include the Name of the instance and owner (team or individual on Slack) from the appropriate tags.</p>

<h2>
<a id="prerequisite" class="anchor" href="#prerequisite" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Prerequisite</h2>

<p>The lambda function assumes that all resources (EC2 instances) are tagged with a key <code>Owner</code> specifying the owner of the resource.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p>Update <code>lambda/config.json</code> with necessary config for your environment. The keys are explained below:</p>

<p><code>store.simpledb.domain</code> - The lambda function keeps track of processed events in AWS simbedb. This configures the simpledb domain to be used for this purpose.</p>

<p><code>notification.slack</code></p>

<ul>
<li>
<code>hook</code> - The slack hook url.</li>
<li>
<code>channel</code> - The channel to send the notifications to.</li>
<li>
<code>icon</code> - Icon to use for the bot that sends the notification.</li>
<li>
<code>username</code> - Username of the bot that sends the notification.</li>
<li>
<code>owners</code> - List of owners per tag. The keys here will be the value of the tag <code>Owner</code>. This maps the tag value to owners on slack - for example - <code>"devops : { "owner": "@devops_team"}"</code>

<ul>
<li>
<code>all</code> - this is a catchall owner that is used as default if the resource did not have the <code>Owner</code> tag.</li>
</ul>
</li>
</ul>

<h3>
<a id="manual" class="anchor" href="#manual" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Manual</h3>

<p>Once the <code>config.json</code> has been updated, the lambda function can be manually installed by doing a <code>npm install --production</code>, zipping up the entire lambda folder and uploading to AWS like any other lambda function.</p>

<h3>
<a id="terraform" class="anchor" href="#terraform" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Terraform</h3>

<p>The repo also has terraform plans to setup the lambda function - including the necessary IAM roles and lambda schedule (once an hour by default). A normal <code>terraform plan</code> and <code>terraform apply</code> should fully setup the lambda function. Requires  terraform 0.7.8+.</p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>

<p>This is an open source project licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/indix/aws-maintenance-lambda">aws-maintenance-lambda</a> is maintained by <a href="https://github.com/indix">indix</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
